# 블록체인(이더리움) 과 솔리티디 



## 블록체인이란?

1. 순서가 정렬된 일련의 블록 들이 연결된 체인
2. 블록이란, 데이터의 집합이면 데이터 에는 송금 기록등이 있음
3. 각각의 사용자들은 같은 정보에 블록을 가지고 있음
4. 블록체인은 모두가 접근 가능함
5. 블록체인을 조작지 모든 개인의 정보를 변경해야함
6. 암호학 기반으로 설계됨 



## 1.1 블록(block)

1. 메타정보를 담은 헤더(header)와 일련의 트랜잭션으로 구성됨

2. 채굴자가 채굴해 생성되고 네트워크의 다른 노드로 브로드캐스트됨

3. 모든 노드는 일련의 합의 규칙에 따라 수신된 블록을 확인하고, 합의 규칙을 총족시키지 못하는 블록은 네트워크에서 거부됨

   

   ## 포크(Fork)

   1. 네트워크가 합의 규칙을 두고 경쟁하는 둘 이상의 집합으로 나눠질 때 발생하는 이벤트

   2. Geth(이더리엄의 공식 client 프로그램)라는 소프트웨어가 업데이트될 때 포크가 발생함

      

   ## 소프트 포크(Soft Fork)

   1. 새로운 규칙 집합이 이전 규칙의 하위 집합일 떄 발생한다.
   2. 새로운 규칙이 이전 규칙과 호환되므로, 블록 생성자(채굴자)만 소프트웨어를 업그레이드 하면 됨

   

   ## 하드 포크(Hard Fork)

   1. 새로운 규칙이 이전 규칙과 호환되지 않으므로, 모든 client가 소프트웨어를 업그레이해야 함
   2. 만약 사용자 그룹이 소프트웨어 업데이트를 거부하면 체인의 분할이 발생하고 한 체인에서 유효한 블록은 다른 체인에서 유효하지 않게 되기 때문이다.



## 1.2 채굴(mining)

1. 이더리움 네트워크의 채굴(mining) 노드는 이더해시(Ethash) 라는 독자적인 작업 증명 알고리즘을 사용해 블록을 생성하고자 경쟁함.
2. 네트워크가 채굴된 블록을 수용하려면 블록 헤더에 대한 Ethash 출력이 네트워크 난이도보다 적어야 하며 또다른 32byte의 16진수가 채워질 대상으로 사용됨
3. 때로는 두 채굴자가 같은 시간에 한 블록을 생산하고 오직 하나만 주 체인에 합류하게된다. 수용되지 않은 블록을 엉클 블록(uncle block)이라고 한다.
4. 블록체인의 보안은 네트워크의 해시파워에 비례함.
5. 네트워크 난이도는 지속 조정되며, 난이도 조절로 15~30초마다 블록을 생성하도록 만듬



## 1.3 트랜잭션(transaction)

1. 이더를 전송하거나 스마트 컨트랙트를 배포하거나 배포된 컨트랙트의 함수를 실행함.
2. 코드 작업의 복잡성과 네트워크 비용을 결정하는 이더리움의  측정 단위인 gas를 소모함.
3. 트랜잭션을 실행하는 주소는 채굴자에게 트랜잭션 수수료를 지불함.
4. 트랜잭션에는 데이터 필드가 선택적으로 포함될 수 있다. ex) 컨트랙트 배포 트랜잭션 -> 컨트랙트의 바이트코드 , 스마트 컨트랙트 -> 호출할 함수의 명과 인수



## 1.4 EVM(Ethereum Virtual Machine)

1. VM은 프로세서를 흉내내는 소프트웨어 프로그램
2. 어느 하드웨어에서 실행하든 상관없는 이점이 있음
3. 스마트 컨트랙트를 어떻게 설계하느냐에 따라 수수료를 절감할 수 있음
4. 트랜잭션의 바이트코드에 의해 누적된 가스 요금의 합계가 총 트랜잭션 수수료를 결정함.



## 1.5 상대트리

1. 이더리움의 기본 데이터베이스는 Keccak256 해시 키를 32byte 값에 매핑하는, 키/값 쌍으로 구성된 상대 트리(state tree) 이다.
2. Keccak256 해시는 256비트 길이이므로, 이더리움 상대 트리는 최대 2,256개의 고유 항목을 저장하도록 설계됨.
3. 상대 트리는 머클-패트리샤 트리로 구현된다.





## 라이트노드



## 거래검증



## 스마트 계약

**스마트 계약** 또는 **스마트 컨트랙트**(smart contract)는 계약 당사자가 사전에 협의한 내용을 미리 프로그래밍하여 전자 계약서 문서 안에 넣어두고, 이 계약 조건이 모두 충족되면 자동으로 계약 내용이 실행되도록 하는 시스템이다. 기존의 [블록체인](http://wiki.hash.kr/index.php/블록체인) 1.0 기술이 '과거에 일어났던 일'을 기록한다면, 스마트 계약 기능을 구현한 블록체인 2.0 기술은 '미래에 일어날 일'을 미리 기록해 둘 수 있다



## 블록체인과 이더리움의 문제

1. 프라이버시 : 데이터가 평생 기록에 남는다
2. 트랜잭션 코스트 : 가스라는 수수료를 사용자가 부담하다. 
3. 트랜잭션 스피드 :  이더리움은 10번정도 무결성을 컨펌해야 체결됨
4. 블록 사이즈



## 솔리디티

1. 스마트 컨트랙트를 만들기 위한 언어
2. EVM(Ethereum Virtual Machine) 으로 설계됨
3. 정적 타입
4. 스마트 컨트랙트를 블록체인으로 올라가면 수정이 불가능하고 누구나 볼 수 있다.
5. 가스리밋 : 수수료 한계치
6. 가스프라이스 : 가스 당 가격
7. 가스 프라이스 * 가스 사용량 = 수수료

 
